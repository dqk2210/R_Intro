# BÀI 4: KIỂU DỮ LIỆU PHÂN LOẠI (FACTOR) TRONG R

## 1. Tại sao cần Factor khi đã có Vector?
Thông thường, Vector chuỗi (Character) dùng để lưu trữ văn bản tự do. Tuy nhiên, trong phân tích dữ liệu, chúng ta thường gặp loại dữ liệu "định danh" hoặc "thứ bậc".

* Ví dụ: Nếu dùng Vector chuỗi để lưu size áo "S", "M", "L", R sẽ hiểu đây chỉ là các chữ cái và sắp xếp chúng theo bảng chữ cái (L -> M -> S). 
* Để R hiểu được "S" nhỏ hơn "M" và nhỏ hơn "L", chúng ta phải dùng Factor.

Factor giúp R:
- Tiết kiệm bộ nhớ (lưu dưới dạng các con số nguyên đi kèm nhãn).
- Xác định đúng thứ tự ưu tiên trong phân tích và vẽ biểu đồ.
- Hỗ trợ các mô hình thống kê phân loại.

---

## 2. Factor là gì?
Factor là kiểu dữ liệu đặc biệt dùng để lưu trữ dữ liệu phân loại (categorical data) với các mức độ (levels) xác định.


---

## 3. Phân loại Factor

### 3.1. Unordered Factor (Không có thứ tự)
Dùng cho dữ liệu chỉ mang tính chất định danh, không so sánh cao thấp.
Ví dụ: Màu sắc, giới tính, quốc gia...

Mã mẫu:
```{r}
colors <- factor(c("red", "green", "blue", "yellow"))
class(colors)
levels(colors)
```

### 3.2. Ordered Factor (Có thứ tự)
Dùng cho dữ liệu có sự phân cấp rõ rệt.
Ví dụ: Trình độ học vấn, mức độ hài lòng, size quần áo...

Mã mẫu:
```{r}
ratings <- factor(c("low", "high", "medium"),
                  levels = c("low", "medium", "high"), # Xác định thứ tự
                  ordered = TRUE
                  )
ratings
```

---

## 4. Các ví dụ thực tế trong phân tích dữ liệu

### Ví dụ 1: Quản lý trình độ giáo dục (Education)
```{r}
education <- factor(c("High School", "Bachelor", "Master", "PhD"),
                    levels = c("High School", "Bachelor", "Master", "PhD"),
                    ordered = TRUE)
str(education)
levels(education)
```

### Ví dụ 2: Phân loại điểm số học sinh
```{r}
grades <- factor(
  c("Giỏi", "Khá", "Trung bình", "Giỏi", "Khá", "Yếu"),
  levels = c("Yếu", "Trung bình", "Khá", "Giỏi"),
  ordered = TRUE
)
table(grades)
```

### Ví dụ 3: Khảo sát mức độ hài lòng (Customer Satisfaction)
```{r}
satisfaction <- factor(
  c("Rất thích", "Thích", "Bình thường", "Không thích", "Thích", "Rất thích"),
  levels = c("Không thích", "Bình thường", "Thích", "Rất thích"),
  ordered = TRUE
)
tab_sat <- table(satisfaction)
barplot(tab_sat, main="Kết quả khảo sát khách hàng", col="lightgreen")
```
---

## 5. Lưu ý khi chọn kiểu dữ liệu
- Số thực/Số nguyên (Tuổi, ID): Numeric / Integer
- Văn bản tự do (Tên, địa chỉ): Character
- Dữ liệu thể loại (Size, Học vấn): Factor

---

## 6. Bài tập thực hành tại lớp
Yêu cầu:
1. Tạo một Vector chứa kích cỡ áo của 10 khách hàng: M, L, S, XL, M, S, M, L, XL, M.
2. Chuyển Vector trên thành Factor có thứ tự từ nhỏ đến lớn: S < M < L < XL.
3. Sử dụng hàm summary() để thống kê số lượng từng size áo.

Mã gợi ý:
```{r}
sizes <- factor(
  c("M", "L", "S", "XL", "M", "S", "M", "L", "XL", "M"),
  levels = c("S", "M", "L", "XL"),
  ordered = TRUE
)
summary(sizes)
plot(sizes, main="Thống kê kích cỡ áo", col="orange")
```